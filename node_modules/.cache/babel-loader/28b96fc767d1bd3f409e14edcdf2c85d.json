{"ast":null,"code":"var _jsxFileName = \"/Users/isabelle/Documents/College/Spring 2020/CS91R/voting-methods/src/viz/Landing.js\";\nimport React, { Component } from 'react';\nimport { select, selectAll, mouse } from 'd3-selection';\nimport { csv } from 'd3-fetch';\nimport { path } from 'd3-path';\nimport { geoPath } from 'd3-geo';\nimport { geoRobinson } from 'd3-geo-projection'; //import d3Tip from 'd3-tip';\n\nimport * as topojson from 'topojson-client';\nimport topoData from '../assets/data/countries.json';\nconst d3 = {\n  select,\n  selectAll,\n  mouse,\n  csv,\n  path,\n  geoRobinson,\n  geoPath\n};\nexport default class Landing extends Component {\n  componentDidMount() {\n    d3.csv(`${process.env.PUBLIC_URL}/data/voting-methods-country.csv`).then(res => {\n      this.initialize();\n    });\n  }\n\n  initialize(topoData, voteData) {\n    const margin = {\n      top: 20,\n      right: 40,\n      bottom: 40,\n      left: 40\n    };\n    const width = 1200 - margin.left - margin.right;\n    const height = 800 - margin.top - margin.bottom;\n    var svg = d3.select('#viz').append('svg').attr('width', width).attr('height', height);\n    var systems = d3.nest().key(d => d[\"Electoral system for national legislature\"]).entries(voteData).map(d => d.key);\n    console.log(systems);\n    const color = d3.scaleOrdinal().domain(systems).range([\"#48A36D\", \"#64B98C\", \"#80CEAA\", \"#7FC9BD\", \"#7EC4CF\", \"#7FB1CF\", \"#809ECE\", \"#8F90CD\", \"#9E81CC\", \"#B681BE\", \"#CE80B0\", \"#D76D8F\", \"#E05A6D\", \"#E26962\", \"#E37756\", \"#E39158\", \"#E2AA59\", \"#DFB95C\", \"#DBC75F\", \"#EAD67C\"]);\n    svg.append('g').attr('class', 'methods').selectAll('text').data(systems).enter().append('text').text(d => d).style('fill', d => color(d)).attr('transform', (d, i) => 'translate(1000,' + (100 + 40 * i) + ')').on('mouseover', function (d) {\n      svg.select('.methods').style('cursor', 'pointer');\n      update(svg, d);\n    }).on('mouseout', function (d) {\n      svg.select('.methods').style('cursor', 'default');\n      update(svg, null);\n    });\n    svg.append('g').attr('class', 'map-base');\n    update(svg, null);\n\n    function update(svg, system) {\n      // console.log(topoData);\n      // console.log(voteData);\n      //console.log(system);\n      var projection = d3.geoRobinson().scale(160).translate([svg.attr('width') / 2 - 100, svg.attr('height') / 2]);\n      const path = d3.geoPath().projection(projection);\n      var filteredVoteData;\n      var entries;\n\n      if (system) {\n        filteredVoteData = voteData.filter(d => d[\"Electoral system for national legislature\"] === system);\n        entries = d3.nest().key(d => d.Country).object(filteredVoteData);\n      } else {\n        filteredVoteData = voteData;\n        entries = [];\n      } //console.log(entries);\n      // var countries = entries.map((d) => d.key );\n      //console.log(countries);\n\n\n      const world = topojson.feature(topoData, topoData.objects.countries).features; // var topoCountries = world.map((d) => d.properties.name);\n      //var unmatchedCountries = countries.filter((c) => !topoCountries.includes(c));\n      //console.log(unmatchedCountries);\n\n      var mapBase = svg.select('.map-base');\n      var mapSelect = mapBase.selectAll('path').data(world);\n      mapSelect.exit().remove();\n      var map = mapSelect.enter().append('path').merge(mapSelect).attr('d', path).transition().attr('fill', function (d) {\n        if (entries[convertCountry(d.properties.name)]) {\n          return color(system);\n        } else {\n          return '#eeedf0';\n        }\n      }).attr('stroke', '#dcdfe3').attr('stroke-width', 1).style('opacity', function (d) {\n        return 1;\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"viz\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/isabelle/Documents/College/Spring 2020/CS91R/voting-methods/src/viz/Landing.js"],"names":["React","Component","select","selectAll","mouse","csv","path","geoPath","geoRobinson","topojson","topoData","d3","Landing","componentDidMount","process","env","PUBLIC_URL","then","res","initialize","voteData","margin","top","right","bottom","left","width","height","svg","append","attr","systems","nest","key","d","entries","map","console","log","color","scaleOrdinal","domain","range","data","enter","text","style","i","on","update","system","projection","scale","translate","filteredVoteData","filter","Country","object","world","feature","objects","countries","features","mapBase","mapSelect","exit","remove","merge","transition","convertCountry","properties","name","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { select, selectAll, mouse } from 'd3-selection';\nimport { csv } from 'd3-fetch';\nimport { path } from 'd3-path';\nimport { geoPath } from 'd3-geo';\nimport { geoRobinson } from 'd3-geo-projection';\n//import d3Tip from 'd3-tip';\nimport * as topojson from 'topojson-client';\n\nimport topoData from '../assets/data/countries.json';\n\nconst d3 = { select, selectAll, mouse, csv, path, geoRobinson, geoPath };\n\nexport default class Landing extends Component {\n  componentDidMount() {\n    d3.csv(`${process.env.PUBLIC_URL}/data/voting-methods-country.csv`).then(res => {\n      this.initialize()\n    });\n  }\n\n  initialize(topoData, voteData) {\n\n\n   const margin = { top: 20, right: 40, bottom: 40, left: 40 };\n\n  const width = 1200 - margin.left - margin.right;\n  const height = 800 - margin.top - margin.bottom;\n\n  var svg = d3\n      .select('#viz')\n      .append('svg')\n      .attr('width', width)\n      .attr('height', height);\n\n    var systems = d3.nest()\n        .key((d) => d[\"Electoral system for national legislature\"])\n        .entries(voteData)\n        .map((d) => d.key);\n    console.log(systems);\n\n\n    const color = d3\n        .scaleOrdinal()\n        .domain(systems)\n        .range([\"#48A36D\", \"#64B98C\", \"#80CEAA\", \"#7FC9BD\", \"#7EC4CF\", \"#7FB1CF\", \"#809ECE\", \"#8F90CD\", \"#9E81CC\", \"#B681BE\", \"#CE80B0\", \"#D76D8F\", \"#E05A6D\", \"#E26962\", \"#E37756\", \"#E39158\", \"#E2AA59\", \"#DFB95C\", \"#DBC75F\", \"#EAD67C\"]);\n\n  svg.append('g')\n      .attr('class', 'methods')\n      .selectAll('text')\n      .data(systems)\n      .enter()\n      .append('text')\n      .text((d) => d)\n      .style('fill', (d) => color(d))\n      .attr('transform', (d, i) => 'translate(1000,' + (100+ 40*i) + ')')\n      .on('mouseover', function(d) {\n          svg.select('.methods').style('cursor', 'pointer');\n        update(svg, d);\n      }).on('mouseout', function(d) {\n      svg.select('.methods').style('cursor', 'default');\n      update(svg, null);\n  });\n\n  svg.append('g')\n      .attr('class', 'map-base')\n\n  update(svg, null);\n\n  function update(svg, system) {\n      // console.log(topoData);\n      // console.log(voteData);\n      //console.log(system);\n\n     var projection = d3\n        .geoRobinson()\n        .scale(160)\n        .translate([svg.attr('width') / 2 - 100, svg.attr('height') / 2]);\n\n     const path = d3.geoPath().projection(projection);\n      var filteredVoteData;\n      var entries;\n     if (system) {\n         filteredVoteData = voteData.filter((d) => d[\"Electoral system for national legislature\"] === system);\n         entries = d3.nest()\n             .key((d) => d.Country )\n             .object(filteredVoteData);\n     } else {\n         filteredVoteData = voteData;\n         entries = [];\n     }\n\n\n     //console.log(entries);\n\n    // var countries = entries.map((d) => d.key );\n     //console.log(countries);\n\n     const world = topojson.feature(topoData, topoData.objects.countries).features;\n    // var topoCountries = world.map((d) => d.properties.name);\n\n    //var unmatchedCountries = countries.filter((c) => !topoCountries.includes(c));\n    //console.log(unmatchedCountries);\n    var mapBase = svg.select('.map-base');\n\n     var mapSelect = mapBase\n        .selectAll('path')\n        .data(world);\n\n     mapSelect.exit().remove();\n\n      var map = mapSelect.enter()\n        .append('path')\n          .merge(mapSelect)\n\n        .attr('d', path)\n          .transition()\n        .attr('fill', function(d) {\n            if (entries[convertCountry(d.properties.name)]) {\n                return color(system);\n            } else {\n                return '#eeedf0';\n            }\n        })\n        .attr('stroke', '#dcdfe3')\n        .attr('stroke-width', 1)\n        .style('opacity', function(d) {\n          return 1;\n        });\n\n  }\n\n}\n\n  render() {\n    return (\n        <div id=\"viz\"></div>\n\n      )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}